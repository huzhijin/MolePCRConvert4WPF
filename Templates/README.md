<!--
 * @Author: 胡志锦 13089116+huzhijin1213@user.noreply.gitee.com
 * @Date: 2025-04-21 11:30:13
 * @LastEditors: 胡志锦 13089116+huzhijin1213@user.noreply.gitee.com
 * @LastEditTime: 2025-04-21 14:58:27
 * @FilePath: /MolePCRConvert4WPF/Templates/README.md
 * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
-->
# PCR分析报告模板目录

此目录用于存放PCR分析报告的Excel模板文件。模板文件将被ExcelReportGenerator服务使用，用于生成分析报告。

## 模板文件命名规则

所有的Excel模板文件(.xlsx)都会被系统扫描并显示在模板选择对话框中。模板的文件名将作为选择列表中显示的名称。

## 如何创建有效的模板

1. 创建一个新的Excel文件(.xlsx格式)
2. 设计报表布局，可以包含以下元素：
   - 标题和页眉
   - 公司/实验室信息
   - 报告生成日期（将自动填充）
   - 数据表格（用于填充分析结果）
   - 结果解释区域
   - 签名区域等

3. 添加占位符标记，用于数据填充
4. 保存模板文件到此目录

## 重要注意事项

- 模板文件必须为.xlsx格式
- 在模板中不要使用复杂的Excel公式
- 为保证兼容性，建议使用基本样式和格式

## 占位符标记

在报告模板中，可以使用以下文本作为占位符，系统会自动替换：

### 通用占位符

- `[[PlateID]]` - 板ID
- `[[PlateName]]` - 板名称
- `[[Date]]` - 报告生成日期
- `[[TotalSamples]]` - 样本总数
- `[[PositiveCount]]` - 阳性样本数量
- `[[NegativeCount]]` - 阴性样本数量

### 数据表格标记

在你希望填充数据表格的位置，添加一个特殊的标记单元格：

- `[[DataStart]]` - 标记数据表格的起始位置

系统会从这个位置开始，按照以下方式填充数据：

- **患者报告**：按患者分组显示数据，每组包含患者信息和所有相关的检测结果
- **整板报告**：按孔位顺序显示整板的所有数据

## 样式建议

为了使生成的报告美观一致，建议：

1. 为标题行设置背景色和粗体
2. 为数据单元格设置适当的边框
3. 设置合理的列宽以确保数据完整显示
4. 使用冻结窗格以便于查看大量数据
5. 添加页眉和页脚，便于打印

## 示例模板

以下是两种典型的报告模板：

1. **患者报告模板**：按患者分组展示结果，适合生成患者报告
2. **整板报告模板**：显示整个板的结果，适合实验室内部使用

可以使用相同的模板文件生成患者报告或整板报告，只需在生成时选择对应的报告类型即可。

更多占位符和高级功能将随应用程序的开发添加，请参考最新的开发文档。 